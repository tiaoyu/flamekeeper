# 守焰者 / Flame Keeper
## 游戏设计文档 (GDD)

**版本**: 2.0  
**最后更新**: 2026-01-10  
**状态**: 设计阶段

---

## 目录

1. [概述](#1-概述)
2. [核心玩法](#2-核心玩法)
3. [游戏机制](#3-游戏机制)
4. [资源系统](#4-资源系统)
5. [建筑系统](#5-建筑系统)
6. [敌人系统](#6-敌人系统)
7. [火种系统](#7-火种系统)
8. [关卡设计](#8-关卡设计)
9. [用户界面](#9-用户界面)
10. [美术风格](#10-美术风格)
11. [音效设计](#11-音效设计)
12. [技术规格](#12-技术规格)
13. [新手引导系统](#13-新手引导系统)
14. [游戏模式](#14-游戏模式)
15. [成就与解锁系统](#15-成就与解锁系统)
16. [反馈系统](#16-反馈系统)
17. [难度系统](#17-难度系统)

---

## 1. 概述

### 1.1 游戏概念

**守焰者** 是一款 2D 俯视角塔防建造游戏。玩家在被黑暗笼罩的世界中，守护最后的火种，通过采集资源、建造防御工事来抵御从黑暗中涌来的怪物。

### 1.2 核心卖点

- **光明 vs 黑暗**: 独特的"火种照明"机制，只有被照亮的区域才能活动
- **建造 + 塔防**: 红警式的基地建设 + 塔防式的波次防御
- **资源管理**: 采集、加工、建造的完整产业链
- **紧迫感**: 波次倒计时带来的策略压力

### 1.3 目标平台

- Web 浏览器
- 移动端 (iOS / Android)

### 1.4 目标受众

- 喜欢塔防游戏的玩家
- 喜欢建造经营的玩家
- 休闲策略游戏爱好者
- 年龄: 12+

### 1.5 游戏时长

- **单局时长**: 15-30 分钟
- **目标波次**: 15 波
- **重玩价值**: 随机地图、不同策略路线

---

## 2. 核心玩法

### 2.1 游戏循环

开局 → 火种点燃，照亮初始区域
↓
建造期 → 采集资源，建造/升级建筑
↓
防御期 → 怪物进攻，防御塔自动攻击
↓
结算 → 存活则进入下一波，否则游戏结束
↓
(循环) 难度递增，直到火种满级或被摧毁


### 2.2 胜利条件

- 将火种升级到 **Lv.5**（最高级）
- 或存活 **15 波**怪物进攻

### 2.3 失败条件

- **火种被摧毁**（血量归零）

### 2.4 核心操作

| 操作 | 方式 |
|------|------|
| 选择建筑 | 点击底部建筑栏 |
| 放置建筑 | 点击地图上的合法位置 |
| 批量放置 | 选中建筑后拖拽放置多个（城墙等） |
| 升级建筑 | 点击已有建筑 → 升级按钮 |
| 拆除建筑 | 点击已有建筑 → 拆除按钮（返还 50% 资源）|
| 移动视角 | 拖拽屏幕 / WASD 键 |
| 缩放视角 | 双指缩放 / 鼠标滚轮 |
| 战斗加速 | 点击加速按钮切换 1x/2x 速度 |
| 跳过等待 | 建造期点击"立即开始"跳过倒计时 |

---

## 3. 游戏机制

### 3.1 迷雾系统（光明与黑暗）

**核心规则**:
- 地图初始被"黑暗迷雾"笼罩
- 火种照亮周围一定半径的区域
- 只有被照亮的区域可以：
  - 看到地形和资源
  - 放置建筑
  - 看到敌人（敌人在黑暗中不可见）
- 敌人从黑暗区域的地图边缘刷出

**设计意图**:
- 创造探索感
- 限制初期扩张速度
- 让火种升级有明确收益

### 3.2 波次系统

| 参数 | 数值 |
|------|------|
| 总波次 | 15 波 |
| 波次间隔 | 60 秒（可调） |
| 敌人数量增长 | 每波 +20% |
| 敌人血量增长 | 每波 +10% |

**波次预告**:
- 下一波倒计时显示在 UI 上
- 倒计时 10 秒时，提示下一波敌人类型

**波次跳过机制**:
- 建造期间，玩家可点击"立即开始"按钮跳过等待
- 跳过后立即进入下一波战斗
- 适合准备充分或追求速通的玩家

**波次结算奖励**:
| 波次 | 水晶奖励 | 说明 |
|------|---------|------|
| 1-5 | 5 水晶/波 | 基础奖励 |
| 6-10 | 10 水晶/波 | 中期奖励 |
| 11-14 | 15 水晶/波 | 后期奖励 |
| 15 | 50 水晶 | Boss 击杀奖励 |

> **设计说明**: 波次水晶奖励是火种升级的主要水晶来源，确保玩家无需依赖稀有水晶矿也能推进游戏

### 3.3 建造规则

- 建筑只能放置在**照亮的区域**
- 建筑不能重叠
- 建筑不能放在资源点上（树、矿石）
- 部分建筑需要相邻资源（伐木场需要靠近树）

### 3.4 战斗系统

**防御塔行为**:
- 自动攻击射程内的敌人
- 攻击有冷却时间
- 可设置攻击优先级

**防御塔目标优先级设置**:
| 优先级模式 | 描述 | 适用场景 |
|-----------|------|---------|
| 最近优先 | 攻击距离最近的敌人 | 默认模式 |
| 血量最低 | 攻击剩余血量最少的敌人 | 快速清理残血 |
| 血量最高 | 攻击血量最多的敌人 | 集火精英/Boss |
| 速度最快 | 攻击移动速度最快的敌人 | 防止穿透 |
| 飞行优先 | 优先攻击飞行单位 | 箭塔/电磁塔专用 |

> 玩家点击防御塔可切换目标优先级，也可手动点击敌人强制指定攻击目标（持续 5 秒）

**敌人行为**:
- 向火种移动（A* 寻路）
- 遇到城墙会攻击城墙
- 部分敌人会绕过障碍
- 飞行敌人无视地面障碍

---

## 4. 资源系统

### 4.1 资源类型

| 资源 | 图标 | 获取方式 | 主要用途 |
|------|------|---------|---------|
| 木材 | 🪵 | 砍树 / 伐木场 | 基础建筑、箭塔 |
| 石头 | 🪨 | 采矿 / 采石场 | 城墙、高级建筑 |
| 铁矿 | ⛏️ | 熔炉加工 | 高级塔、升级 |
| 水晶 | 🔮 | 稀有矿 / 水晶塔 | 魔法塔、火种升级 |

### 4.2 资源产出数值

| 来源 | 产出速度 | 回本时间 |
|------|---------|---------|
| 手动砍树 | 10 木材/次 | - |
| 伐木场 | 2 木材/秒 | 15 秒 |
| 手动采矿 | 10 石头/次 | - |
| 采石场 | 2 石头/秒 | 15 秒 |
| 熔炉 | 10 石头 → 5 铁/10秒 | 约 140 秒 |
| 水晶塔 | 1 水晶/10秒 | 约 1500 秒 |

> **设计说明**: 资源产出经过平衡调整，确保玩家需要合理规划建造顺序，避免单一建筑过于强力。

### 4.3 资源存储与管理

| 参数 | 数值 |
|------|------|
| 基础存储上限 | 木材 500 / 石头 300 / 铁 100 / 水晶 50 |
| 仓库增加上限 | 每个仓库 +50% 对应资源上限 |
| 资源溢出 | 超过上限的资源将丢失 |
| 资源运输 | 自动入库（无需运输单位） |

**资源枯竭机制**:
- 每棵树可采集 50 木材后消失
- 每块矿石可采集 80 石头后消失
- 水晶矿可采集 30 水晶后消失
- 资源点每 3 波有 20% 概率在地图边缘重生

### 4.4 初始资源

| 难度 | 木材 | 石头 | 铁矿 | 水晶 |
|------|------|------|------|------|
| 简单 | 200 | 100 | 20 | 5 |
| 普通 | 100 | 50 | 10 | 0 |
| 困难 | 50 | 25 | 0 | 0 |

> 详细难度参数见 [第17章 难度系统](#17-难度系统)

---

## 5. 建筑系统

### 5.1 防御建筑

#### 木墙
| 属性 | 数值 |
|------|------|
| 成本 | 5 木材 |
| 血量 | 100 |
| 功能 | 阻挡敌人移动 |
| 解锁 | 火种 Lv.1 |

#### 石墙
| 属性 | 数值 |
|------|------|
| 成本 | 10 石头 |
| 血量 | 300 |
| 功能 | 阻挡敌人移动 |
| 解锁 | 火种 Lv.2 |

#### 箭塔
| 属性 | 数值 |
|------|------|
| 成本 | 20 木材 + 10 石头 |
| 血量 | 150 |
| 伤害 | 25 |
| 攻速 | 1次/秒 |
| 射程 | 5 格 |
| DPS | 25 |
| 解锁 | 火种 Lv.1 |

#### 投石塔
| 属性 | 数值 |
|------|------|
| 成本 | 30 石头 + 15 铁 |
| 血量 | 200 |
| 伤害 | 60 (范围) |
| 攻速 | 0.5次/秒 |
| 射程 | 6 格 |
| 范围 | 2 格 |
| DPS | 30 (单体) / 群体更高 |
| 解锁 | 火种 Lv.2 |

#### 火焰塔
| 属性 | 数值 |
|------|------|
| 成本 | 30 木材 + 15 水晶 |
| 血量 | 120 |
| 伤害 | 8/秒 (持续范围) |
| 效果 | 减速 30% |
| 射程 | 4 格 |
| 照明 | 提供 2 格照明范围 |
| DPS | 8 (控制型) |
| 解锁 | 火种 Lv.3 |

#### 电磁塔
| 属性 | 数值 |
|------|------|
| 成本 | 60 铁 + 40 水晶 |
| 血量 | 180 |
| 伤害 | 30 (链式3目标) |
| 攻速 | 0.6次/秒 |
| 射程 | 5 格 |
| DPS | 18 (单体) / 54 (满链) |
| 解锁 | 火种 Lv.4 |

### 5.2 防御塔数值平衡对比

| 防御塔 | 总成本 | 单体DPS | 性价比 | 定位 |
|-------|-------|--------|--------|------|
| 箭塔 | 30 | 25 | 0.83 | 基础单体输出 |
| 投石塔 | 45 | 30+ | 0.67+ | 群体AOE |
| 火焰塔 | 45 | 8 | 控制型 | 减速+照明 |
| 电磁塔 | 100 | 18-54 | 0.18-0.54 | 高端群体 |

> **平衡说明**: 电磁塔成本提高、攻速降低，确保其作为后期建筑不会完全取代前期防御塔的价值。

### 5.3 生产建筑

#### 伐木场
| 属性 | 数值 |
|------|------|
| 成本 | 30 木材 |
| 血量 | 100 |
| 产出 | 2 木材/秒 |
| 条件 | 需要靠近树木（2格内） |
| 解锁 | 火种 Lv.1 |

#### 采石场
| 属性 | 数值 |
|------|------|
| 成本 | 30 石头 |
| 血量 | 150 |
| 产出 | 2 石头/秒 |
| 条件 | 需要靠近矿石（2格内） |
| 解锁 | 火种 Lv.2 |

#### 熔炉
| 属性 | 数值 |
|------|------|
| 成本 | 50 石头 + 20 木材 |
| 血量 | 200 |
| 转化 | 10 石头 → 5 铁 |
| 周期 | 10 秒 |
| 条件 | 石头充足时自动工作 |
| 解锁 | 火种 Lv.3 |

#### 水晶塔
| 属性 | 数值 |
|------|------|
| 成本 | 100 石头 + 50 铁 |
| 血量 | 250 |
| 产出 | 1 水晶/10秒 |
| 解锁 | 火种 Lv.4 |

### 5.4 功能建筑

#### 仓库
| 属性 | 数值 |
|------|------|
| 成本 | 40 木材 + 20 石头 |
| 血量 | 150 |
| 功能 | 增加 50% 资源存储上限 |
| 解锁 | 火种 Lv.1 |

#### 瞭望塔
| 属性 | 数值 |
|------|------|
| 成本 | 25 木材 + 15 石头 |
| 血量 | 80 |
| 功能 | 提供 6 格视野范围 |
| 特性 | 无攻击能力 |
| 解锁 | 火种 Lv.2 |

#### 修理站
| 属性 | 数值 |
|------|------|
| 成本 | 40 石头 + 20 铁 |
| 血量 | 180 |
| 功能 | 自动修复 3 格内建筑 |
| 修复速度 | 10 血量/秒 |
| 解锁 | 火种 Lv.3 |

#### 尖刺陷阱
| 属性 | 数值 |
|------|------|
| 成本 | 15 木材 + 10 铁 |
| 血量 | 50 |
| 伤害 | 30（触发时） |
| 特性 | 敌人踩踏触发，5秒冷却 |
| 解锁 | 火种 Lv.2 |

#### 减速地带
| 属性 | 数值 |
|------|------|
| 成本 | 20 石头 + 5 水晶 |
| 血量 | 100 |
| 效果 | 减速经过敌人 40% |
| 范围 | 2×2 格 |
| 解锁 | 火种 Lv.3 |

### 5.5 建筑升级

每个建筑可升级 3 次：

| 等级 | 效果 | 成本 |
|------|------|------|
| Lv.2 | 属性 +30% | 基础成本 ×1 |
| Lv.3 | 属性 +60% | 基础成本 ×2 |
| Lv.4 | 属性 +100% | 基础成本 ×3 |

### 5.6 建筑协同效果

**相邻加成**:
| 组合 | 效果 |
|------|------|
| 2个相邻箭塔 | 攻速 +10% |
| 3个相邻城墙 | 血量 +15% |
| 伐木场相邻2棵树 | 产出 +25% |
| 采石场相邻2块矿 | 产出 +25% |
| 火焰塔相邻火种 | 照明范围 +50% |

**建筑组合**:
| 组合 | 触发条件 | 效果 |
|------|---------|------|
| 火力网 | 3个不同类型防御塔相邻 | 所有塔攻击力 +10% |
| 工业区 | 伐木场+采石场+熔炉相邻 | 所有生产效率 +20% |
| 堡垒 | 城墙围成封闭区域 | 区域内建筑血量 +25% |

---

## 6. 敌人系统

### 6.1 敌人列表

#### 小鬼
| 属性 | 数值 |
|------|------|
| 血量 | 50 |
| 伤害 | 10 |
| 速度 | 快 |
| 特性 | 无 |
| 首次出现 | 第 1 波 |

#### 石像鬼
| 属性 | 数值 |
|------|------|
| 血量 | 200 |
| 伤害 | 25 |
| 速度 | 慢 |
| 特性 | 优先攻击城墙 |
| 首次出现 | 第 3 波 |

#### 暗影狼
| 属性 | 数值 |
|------|------|
| 血量 | 80 |
| 伤害 | 20 |
| 速度 | 极快 |
| 特性 | 绕过障碍物 |
| 首次出现 | 第 5 波 |

#### 巨魔
| 属性 | 数值 |
|------|------|
| 血量 | 500 |
| 伤害 | 50 |
| 速度 | 慢 |
| 特性 | 范围攻击 |
| 首次出现 | 第 7 波 |

#### 腐化者
| 属性 | 数值 |
|------|------|
| 血量 | 150 |
| 伤害 | 15 |
| 速度 | 中 |
| 特性 | 攻击感染建筑（效率-50%）|
| 首次出现 | 第 10 波 |

#### 暗翼蝠 (飞行)
| 属性 | 数值 |
|------|------|
| 血量 | 60 |
| 伤害 | 15 |
| 速度 | 快 |
| 特性 | 无视城墙，只能被箭塔/电磁塔攻击 |
| 首次出现 | 第 6 波 |

#### 分裂史莱姆
| 属性 | 数值 |
|------|------|
| 血量 | 120 |
| 伤害 | 20 |
| 速度 | 慢 |
| 特性 | 死亡后分裂成 3 只小史莱姆（各 30 血量） |
| 首次出现 | 第 8 波 |

#### 暗影祭司
| 属性 | 数值 |
|------|------|
| 血量 | 100 |
| 伤害 | 10 |
| 速度 | 慢 |
| 特性 | 每 5 秒为周围敌人恢复 20 血量 |
| 首次出现 | 第 9 波 |

#### 护盾卫士
| 属性 | 数值 |
|------|------|
| 血量 | 180 |
| 伤害 | 25 |
| 速度 | 慢 |
| 特性 | 为 2 格内敌人提供 50% 伤害减免护盾 |
| 首次出现 | 第 11 波 |

#### 爆裂虫
| 属性 | 数值 |
|------|------|
| 血量 | 40 |
| 伤害 | 80 (自爆) |
| 速度 | 极快 |
| 特性 | 接近目标 1 格内自爆，造成范围伤害 |
| 首次出现 | 第 12 波 |

#### 黑暗领主 (Boss)
| 属性 | 数值 |
|------|------|
| 血量 | 2000 |
| 伤害 | 80 |
| 速度 | 慢 |
| 特性 | 每 10 秒召唤 3 只小鬼 |
| 阶段转换 | 50% 血量时进入狂暴，攻速+50% |
| 首次出现 | 第 15 波 |

#### 石巨人 (小Boss)
| 属性 | 数值 |
|------|------|
| 血量 | 800 |
| 伤害 | 60 |
| 速度 | 极慢 |
| 特性 | 对城墙伤害 ×3，免疫减速 |
| 首次出现 | 第 5 波 |

#### 虚空行者 (小Boss)
| 属性 | 数值 |
|------|------|
| 血量 | 600 |
| 伤害 | 40 |
| 速度 | 中 |
| 特性 | 每 8 秒传送到随机位置 |
| 首次出现 | 第 10 波 |

### 6.2 敌人 AI

**寻路规则**:
1. 目标: 火种
2. 使用 A* 算法寻路
3. 遇到城墙: 攻击城墙
4. 城墙被摧毁: 重新寻路

**攻击优先级**:
1. 阻挡路径的城墙
2. 路径上的防御塔
3. 火种

### 6.3 波次设计

| 波次 | 敌人组合 | 难度 | 特殊事件 |
|------|---------|------|---------|
| 1-2 | 小鬼 ×10-15 | 入门 | - |
| 3-4 | 小鬼 + 石像鬼 | 简单 | - |
| 5 | 小鬼 + 暗影狼 + **石巨人** | 中等 | 小Boss战 |
| 6-7 | 混合 + 暗翼蝠 | 中等 | 飞行敌人登场 |
| 8-9 | 混合 + 分裂史莱姆 + 暗影祭司 | 困难 | - |
| 10 | 混合 + **虚空行者** | 困难 | 小Boss战 |
| 11-12 | 混合 + 护盾卫士 + 爆裂虫 | 高难 | - |
| 13-14 | 全种类混合 | 极难 | 四面夹击 |
| 15 | 精英混合 + **黑暗领主** | Boss | 最终决战 |

### 6.4 敌人速度定义

| 速度等级 | 移动速度 | 代表敌人 |
|---------|---------|---------|
| 极慢 | 1 格/秒 | 石巨人 |
| 慢 | 1.5 格/秒 | 石像鬼、巨魔 |
| 中 | 2 格/秒 | 腐化者、虚空行者 |
| 快 | 3 格/秒 | 小鬼、暗翼蝠 |
| 极快 | 4 格/秒 | 暗影狼、爆裂虫 |

---

## 7. 火种系统

### 7.1 火种属性

| 等级 | 血量 | 照亮半径 | 升级成本 | 预期达成波次 | 累计所需水晶 |
|------|------|---------|---------|-------------|-------------|
| Lv.1 | 500 | 5 格 | - | 开局 | 0 |
| Lv.2 | 700 | 8 格 | 30 水晶 | 第 3-4 波 | 30 |
| Lv.3 | 900 | 12 格 | 50 水晶 | 第 6-7 波 | 80 |
| Lv.4 | 1200 | 16 格 | 80 水晶 | 第 10-11 波 | 160 |
| Lv.5 | 1500 | 20 格 | 120 水晶 | 第 14-15 波 | 280 |

**水晶获取途径**:
| 来源 | 获取量 | 说明 |
|------|-------|------|
| 波次奖励 | 5-15/波 | 主要来源，详见波次系统 |
| 水晶矿开采 | 5 水晶/次 | 地图稀有资源点 |
| 水晶塔产出 | 1 水晶/10秒 | 后期稳定来源 |
| Boss 击杀 | 50 水晶 | 第15波奖励 |

**水晶经济平衡**:
- 第1-5波累计奖励：约 25 水晶（可升级到 Lv.2）
- 第1-10波累计奖励：约 75 水晶（可升级到 Lv.3）
- 第1-14波累计奖励：约 165 水晶（可升级到 Lv.4）
- 加上水晶矿和水晶塔，足够在第15波前升级到 Lv.5

> **设计说明**: 火种升级成本已调整，确保仅通过波次奖励也能完成升级，水晶矿和水晶塔提供额外保险

### 7.2 解锁内容

| 火种等级 | 解锁建筑 |
|---------|---------|
| Lv.1 | 木墙、箭塔、伐木场、仓库 |
| Lv.2 | 石墙、投石塔、采石场、瞭望塔、尖刺陷阱 |
| Lv.3 | 火焰塔、熔炉、修理站、减速地带 |
| Lv.4 | 电磁塔、水晶塔 |
| Lv.5 | 胜利！ |

### 7.3 火种恢复

- 火种不会自动恢复血量
- 可消耗 20 水晶恢复 200 血量
- 每波结束后恢复 50 血量

---

## 8. 关卡设计

### 8.1 地图规格

| 参数 | 数值 |
|------|------|
| 地图尺寸 | 40×40 格 |
| 格子大小 | 32×32 像素 |
| 火种位置 | 地图中央 |

### 8.2 地图元素

| 元素 | 描述 |
|------|------|
| 草地 | 可建造区域 |
| 树木 | 木材资源，可砍伐 |
| 矿石 | 石头资源，可开采 |
| 水晶矿 | 稀有水晶资源 |
| 水域 | 不可通过，不可建造 |
| 岩石 | 不可通过，不可建造 |

### 8.3 资源分布

- **树木**: 主要分布在地图四周
- **矿石**: 分散在中等距离
- **水晶矿**: 稀少，分布在较远位置

### 8.4 敌人刷新点

- 地图四边的黑暗区域
- 每波随机选择 1-4 个方向
- 后期波次会四面夹击

---

## 9. 用户界面

### 9.1 主界面布局

┌─────────────────────────────────────────────┐
│ 🪵 156 🪨 89 ⛏️ 34 🔮 12 │ 波次: 5/15 │
├─────────────────────────────────────────────┤
│ │
│ │
│ 游戏主视图 │
│ (地图 + 建筑 + 敌人) │
│ │
│ │
├─────────────────────────────────────────────┤
│ [木墙] [石墙] [箭塔] [投石塔] │ 下波: 45s │
└─────────────────────────────────────────────┘


### 9.2 UI 元素

**顶部状态栏**:
- 资源数量（木材、石头、铁、水晶）
- 当前波次 / 总波次
- 火种血量条

**底部建筑栏**:
- 可用建筑图标
- 建筑成本显示
- 已选中建筑高亮

**右侧信息**:
- 下一波倒计时
- 下一波敌人预告
- "立即开始"按钮（跳过等待）
- 游戏速度切换（1x/2x）
- 设置按钮

**建筑详情面板**:
- 点击已有建筑显示
- 显示当前属性
- 升级/拆除按钮

### 9.3 批量建造模式

**触发方式**: 选中建筑后按住拖拽

**支持建筑**:
- 木墙、石墙（线性拖拽）
- 尖刺陷阱、减速地带（区域拖拽）

**操作反馈**:
- 拖拽时显示预览和总成本
- 资源不足时预览变红
- 松开后一次性建造所有预览建筑

### 9.4 游戏速度控制

| 速度 | 适用场景 | 限制 |
|------|---------|------|
| 1x 正常 | 默认速度 | 无 |
| 2x 加速 | 战斗期快速推进 | 仅战斗期可用 |

> 建造期不支持加速，确保玩家有充足时间规划

---

## 10. 美术风格

### 10.1 整体风格

- **风格**: 像素风 / 低多边形
- **视角**: 2D 俯视 45°
- **色调**: 
  - 光明区域：温暖的橙黄色调
  - 黑暗区域：冷色调蓝紫色

### 10.2 色彩方案

| 元素 | 主色 |
|------|------|
| 火种 | 橙红色 #FF6B35 |
| 照明区域 | 暖黄色渐变 |
| 黑暗区域 | 深紫色 #1A1A2E |
| 草地 | 绿色 #4A7C59 |
| 城墙 | 灰色 #8B8B8B |
| 敌人 | 紫黑色调 |

### 10.3 动画需求

| 对象 | 动画 |
|------|------|
| 火种 | 火焰摇曳 |
| 防御塔 | 攻击动画 |
| 敌人 | 移动、攻击、死亡 |
| 建筑 | 建造完成特效 |
| 资源 | 采集特效 |

---

## 11. 音效设计

### 11.1 背景音乐

| 场景 | 风格 |
|------|------|
| 主菜单 | 神秘、史诗 |
| 建造期 | 平和、紧张感低 |
| 防御期 | 紧张、战斗感 |
| Boss 战 | 高燃、史诗 |
| 胜利 | 欢快、成就感 |
| 失败 | 悲伤、压抑 |

### 11.2 音效列表

| 事件 | 音效 |
|------|------|
| 放置建筑 | 建造音效 |
| 建筑完成 | 完成提示音 |
| 采集资源 | 砍伐/挖掘音 |
| 箭塔攻击 | 弓箭发射 |
| 投石塔攻击 | 石头落地 |
| 火焰塔攻击 | 火焰燃烧 |
| 敌人死亡 | 怪物惨叫 |
| 城墙受击 | 撞击音 |
| 波次开始 | 警报音 |
| 火种受损 | 紧急警报 |

---

## 12. 技术规格

### 12.1 开发环境

| 项目 | 选择 |
|------|------|
| 引擎 | UrhoX |
| 语言 | Lua |
| 渲染 | 2D (NanoVG + Sprite) |
| 平台 | Web / Mobile |

### 12.2 性能目标

| 指标 | 目标 |
|------|------|
| 目标帧率 | 60 FPS |
| 最大敌人数 | 100 同屏 |
| 最大建筑数 | 200 |
| 加载时间 | < 3 秒 |

### 12.3 存档系统

- 自动保存每波结束时的状态
- 支持手动保存/读取
- 存储: 本地存储 (LocalStorage)

### 12.4 核心模块
scripts/
├── main.lua # 入口文件
├── Game/
│ ├── GameManager.lua # 游戏主控制
│ ├── WaveManager.lua # 波次管理
│ └── ResourceManager.lua # 资源管理
├── Map/
│ ├── TileMap.lua # 地图系统
│ └── FogOfWar.lua # 迷雾系统
├── Buildings/
│ ├── BuildingBase.lua # 建筑基类
│ ├── Wall.lua # 城墙
│ └── Tower.lua # 防御塔
├── Enemies/
│ ├── EnemyBase.lua # 敌人基类
│ ├── Goblin.lua # 小鬼
│ └── Boss.lua # Boss
├── UI/
│ ├── HUD.lua # 主界面
│ ├── BuildPanel.lua # 建筑面板
│ └── InfoPanel.lua # 信息面板
└── Utils/
├── Pathfinding.lua # 寻路算法
└── SaveLoad.lua # 存档系统


---

## 附录 A: 数值平衡表

### 经济平衡

| 波次 | 预期资源 | 可建建筑数 |
|------|---------|-----------|
| 1-3 | 200 木 + 100 石 | 5-8 |
| 4-6 | 500 木 + 300 石 | 15-20 |
| 7-9 | 1000 木 + 600 石 + 100 铁 | 30-40 |
| 10+ | 充足 | 50+ |

---

## 附录 B: 开发里程碑

### Phase 1: 核心原型
- [ ] 地图渲染
- [ ] 建造系统
- [ ] 火种与照明
- [ ] 基础敌人 AI

### Phase 2: 战斗系统
- [ ] 防御塔攻击
- [ ] 敌人寻路
- [ ] 波次系统
- [ ] 伤害计算

### Phase 3: 内容完善
- [ ] 全部建筑
- [ ] 全部敌人
- [ ] 数值平衡
- [ ] UI 界面

### Phase 4: 打磨优化
- [ ] 美术资源
- [ ] 音效音乐
- [ ] 性能优化
- [ ] Bug 修复

---

## 附录 C: 参考游戏

| 游戏 | 参考要素 |
|------|---------|
| They Are Billions | 建造 + 波次防御 |
| Mindustry | 资源链 + 塔防 |
| Kingdom | 简化的横版防御 |
| 红色警戒 | 建造界面、即时策略 |

---

## 13. 新手引导系统

### 13.1 引导流程

游戏首次启动时，进入交互式教程模式：

| 步骤 | 教学内容 | 触发条件 | 完成条件 |
|------|---------|---------|---------|
| 1 | 认识火种 | 游戏开始 | 点击火种 |
| 2 | 采集资源 | 步骤1完成 | 手动砍伐一棵树 |
| 3 | 建造建筑 | 步骤2完成 | 放置第一个木墙 |
| 4 | 建造防御塔 | 步骤3完成 | 放置第一个箭塔 |
| 5 | 建造生产建筑 | 步骤4完成 | 放置伐木场 |
| 6 | 迎接第一波 | 步骤5完成 | 存活过第一波 |

### 13.2 引导提示类型

| 提示类型 | 触发条件 | 显示方式 |
|---------|---------|---------|
| 高亮提示 | 引导步骤需要操作 | 目标区域发光+箭头指引 |
| 气泡提示 | 首次看到新元素 | 元素旁显示说明气泡 |
| 警告提示 | 资源不足/危险 | 屏幕边缘闪烁 |
| 成就提示 | 完成特定操作 | 屏幕顶部弹出 |

### 13.3 智能提示系统

游戏进行中的动态提示：

| 场景 | 提示内容 |
|------|---------|
| 资源即将溢出 | "仓库即将满载，考虑建造更多仓库或消耗资源" |
| 防御缺口 | "北侧防御薄弱，敌人可能从此突破" |
| 建筑被攻击 | "箭塔正在受到攻击！" |
| 火种血量低 | "火种血量危急！消耗水晶可恢复血量" |
| 波次即将开始 | "第X波即将来袭，包含[敌人类型]" |
| 新建筑解锁 | "火种升级！新建筑已解锁：[建筑名]" |

### 13.4 帮助系统

- **建筑百科**: 随时查看所有建筑详细信息
- **敌人图鉴**: 已遭遇敌人的属性和弱点
- **操作指南**: 可重新查看操作教程
- **提示开关**: 可关闭智能提示（设置中）

---

## 14. 游戏模式

### 14.1 标准模式

| 参数 | 数值 |
|------|------|
| 总波次 | 15 波 |
| 胜利条件 | 火种 Lv.5 或存活 15 波 |
| 失败条件 | 火种被摧毁 |
| 地图 | 随机生成 |

### 14.2 无尽模式

| 参数 | 数值 |
|------|------|
| 总波次 | 无限 |
| 目标 | 存活尽可能多的波次 |
| 难度增长 | 每波敌人 +25% 血量/数量 |
| 解锁条件 | 标准模式通关 1 次 |

**特殊机制**:
- 每 10 波出现一个随机 Boss
- 每 5 波获得一个随机增益选择（三选一）
- 排行榜记录最高存活波次

### 14.3 每日挑战

| 参数 | 数值 |
|------|------|
| 刷新时间 | 每日 00:00 UTC |
| 地图种子 | 当日固定 |
| 初始条件 | 每日不同（可能有特殊限制） |
| 解锁条件 | 标准模式通关 1 次 |

**挑战类型**:
| 类型 | 描述 |
|------|------|
| 资源限制 | 初始资源减少 50% |
| 建筑限制 | 只能使用特定类型建筑 |
| 速攻挑战 | 波次间隔缩短至 30 秒 |
| 精英入侵 | 所有敌人为精英版本 |
| 黑暗笼罩 | 火种照明范围 -30% |

### 14.4 速通模式

| 参数 | 数值 |
|------|------|
| 总波次 | 10 波 |
| 目标 | 最短时间通关 |
| 计时 | 从第一波开始计时 |
| 解锁条件 | 标准模式通关 3 次 |

**排行榜分类**:
- 全球排行
- 好友排行
- 本周排行

### 14.5 沙盒模式

| 参数 | 数值 |
|------|------|
| 资源 | 无限 |
| 敌人 | 可手动生成 |
| 目的 | 自由建造、测试策略 |
| 解锁条件 | 标准模式通关 5 次 |

**功能**:
- 自由放置任意建筑
- 手动生成任意敌人
- 调整时间流速
- 无失败判定

---

## 15. 成就与解锁系统

### 15.1 成就分类

#### 进度成就
| 成就名 | 条件 | 奖励 |
|-------|------|------|
| 初见曙光 | 首次通关标准模式 | 解锁无尽模式 |
| 守焰老手 | 通关标准模式 3 次 | 解锁速通模式 |
| 守焰大师 | 通关标准模式 5 次 | 解锁沙盒模式 |
| 不灭之火 | 困难难度通关 | 金色火种皮肤 |

#### 挑战成就
| 成就名 | 条件 | 奖励 |
|-------|------|------|
| 完美防御 | 火种未受任何伤害通关 | 成就徽章 |
| 极简主义 | 使用少于 20 个建筑通关 | 成就徽章 |
| 速度之王 | 10 分钟内通关速通模式 | 成就徽章 |
| 无尽征途 | 无尽模式存活 30 波 | 暗金火种皮肤 |
| 百战不殆 | 击杀 10000 只敌人 | 成就徽章 |

#### 探索成就
| 成就名 | 条件 | 奖励 |
|-------|------|------|
| 建筑大师 | 建造所有类型建筑 | 成就徽章 |
| 怪物猎人 | 遭遇所有类型敌人 | 敌人图鉴完成 |
| 火种觉醒 | 将火种升级到 Lv.5 | 成就徽章 |

### 15.2 解锁内容

| 解锁项 | 解锁条件 |
|-------|---------|
| 无尽模式 | 首次通关标准模式 |
| 每日挑战 | 首次通关标准模式 |
| 速通模式 | 通关标准模式 3 次 |
| 沙盒模式 | 通关标准模式 5 次 |
| 困难难度 | 普通难度通关 |
| 金色火种皮肤 | 困难难度通关 |
| 暗金火种皮肤 | 无尽模式 30 波 |

### 15.3 统计数据

游戏记录以下数据：
- 总游戏时长
- 总通关次数
- 总击杀敌人数
- 最高存活波次（无尽模式）
- 最快通关时间（速通模式）
- 建造建筑总数
- 采集资源总量

---

## 16. 反馈系统

### 16.1 战斗反馈

#### 伤害数字
| 类型 | 显示样式 |
|------|---------|
| 普通伤害 | 白色数字，向上飘动 |
| 暴击伤害 | 黄色加大数字，抖动效果 |
| 治疗 | 绿色数字，向上飘动 |
| 护盾伤害 | 蓝色数字 |

#### 击杀反馈
- 敌人死亡播放消散动画
- 击杀音效
- 累计击杀数显示（波次内）

### 16.2 建筑反馈

| 事件 | 反馈效果 |
|------|---------|
| 建造完成 | 建筑从地面升起动画 + 完成音效 |
| 建筑受损 | 建筑显示裂痕 + 血条 |
| 建筑被摧毁 | 倒塌动画 + 碎片效果 |
| 建筑升级 | 升级光效 + 等级标识变化 |
| 生产完成 | 资源飘向火种动画 |

### 16.3 预警系统

#### 敌人来袭预警
| 预警等级 | 触发条件 | 显示方式 |
|---------|---------|---------|
| 低 | 波次开始 | 屏幕边缘方向指示 |
| 中 | 敌人接近防线 | 边缘闪烁 + 警报音 |
| 高 | 敌人突破防线 | 红色边框 + 紧急警报 |

#### 方向指示器
- 屏幕边缘显示敌人来袭方向
- 箭头大小表示敌人数量
- 箭头颜色表示威胁等级（绿/黄/红）

### 16.4 资源反馈

| 事件 | 反馈效果 |
|------|---------|
| 资源获取 | +X 数字飘向资源栏 |
| 资源消耗 | -X 数字从资源栏飘出 |
| 资源不足 | 资源图标闪红 + 提示音 |
| 存储满载 | 资源图标变金色 + 警告 |

### 16.5 效率可视化

| 信息 | 显示方式 |
|------|---------|
| 防御塔DPS | 选中时显示当前输出 |
| 生产效率 | 生产建筑上方显示产出速度 |
| 建筑血量 | 受损时显示血条 |
| 范围预览 | 放置/选中时显示攻击/效果范围 |

---

## 17. 难度系统

### 17.1 难度等级

| 参数 | 简单 | 普通 | 困难 |
|------|------|------|------|
| 初始木材 | 200 | 100 | 50 |
| 初始石头 | 100 | 50 | 25 |
| 初始铁矿 | 20 | 10 | 0 |
| 初始水晶 | 5 | 0 | 0 |
| 敌人血量系数 | 0.8x | 1.0x | 1.3x |
| 敌人伤害系数 | 0.8x | 1.0x | 1.2x |
| 波次间隔 | 90 秒 | 60 秒 | 45 秒 |
| 火种波次回血 | 100 | 50 | 0 |
| 建筑成本系数 | 0.8x | 1.0x | 1.2x |
| 资源产出系数 | 1.2x | 1.0x | 0.8x |

### 17.2 难度解锁

| 难度 | 解锁条件 |
|------|---------|
| 简单 | 默认解锁 |
| 普通 | 默认解锁 |
| 困难 | 普通难度通关 |

### 17.3 难度特殊规则

**简单模式特殊规则**:
- 第一波延迟至 120 秒
- 智能提示默认开启
- Boss 血量 -20%

**困难模式特殊规则**:
- 迷雾范围 +20%
- 敌人刷新点 +1
- Boss 拥有额外技能
- 资源点更稀少

---

## 附录 D: 游戏状态流转

```
[主菜单]
    ↓ 开始游戏
[选择模式] → 标准/无尽/每日挑战/速通/沙盒
    ↓ 选择难度
[加载中]
    ↓ 加载完成
[建造期] ←──────────────┐
    ↓ 倒计时结束         │
[战斗期]                 │
    ↓ 波次结束           │
[波次结算] ─────────────┘
    ↓ 火种被摧毁 / 胜利条件达成
[游戏结束]
    ↓ 返回
[主菜单]
```

---

## 附录 E: 核心事件系统

### 游戏事件列表

| 事件名 | 触发时机 | 携带数据 |
|-------|---------|---------|
| OnGameStart | 游戏开始 | 难度、模式 |
| OnGameEnd | 游戏结束 | 胜负、波次、时长 |
| OnWaveStart | 波次开始 | 波次号、敌人列表 |
| OnWaveEnd | 波次结束 | 波次号、存活敌人数 |
| OnBuildingPlaced | 建筑放置 | 建筑类型、位置 |
| OnBuildingDestroyed | 建筑被摧毁 | 建筑类型、位置 |
| OnBuildingUpgraded | 建筑升级 | 建筑类型、新等级 |
| OnEnemySpawned | 敌人生成 | 敌人类型、位置 |
| OnEnemyKilled | 敌人死亡 | 敌人类型、击杀者 |
| OnResourceChanged | 资源变化 | 资源类型、变化量 |
| OnFlameUpgraded | 火种升级 | 新等级 |
| OnFlameDamaged | 火种受伤 | 伤害量、剩余血量 |
| OnAchievementUnlocked | 成就解锁 | 成就ID |

---

## 附录 F: 数据配置结构

### 建筑配置示例

```lua
BuildingConfig = {
    arrow_tower = {
        name = "箭塔",
        cost = { wood = 20, stone = 10 },
        hp = 150,
        damage = 25,
        attack_speed = 1.0,
        range = 5,
        unlock_level = 1,
        upgrades = {
            [2] = { hp_mult = 1.3, damage_mult = 1.3, cost_mult = 1.0 },
            [3] = { hp_mult = 1.6, damage_mult = 1.6, cost_mult = 2.0 },
            [4] = { hp_mult = 2.0, damage_mult = 2.0, cost_mult = 3.0 },
        }
    },
    -- 更多建筑...
}
```

### 敌人配置示例

```lua
EnemyConfig = {
    goblin = {
        name = "小鬼",
        hp = 50,
        damage = 10,
        speed = 3.0,
        first_wave = 1,
        special = nil,
    },
    flying_bat = {
        name = "暗翼蝠",
        hp = 60,
        damage = 15,
        speed = 3.0,
        first_wave = 6,
        special = { flying = true, target_types = {"arrow_tower", "lightning_tower"} },
    },
    -- 更多敌人...
}
```

---

**文档结束**

*守焰者 / Flame Keeper - 愿火焰永不熄灭。*