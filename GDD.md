# 守焰者 / Flame Keeper
## 游戏设计文档 (GDD)

**版本**: 1.0  
**最后更新**: 2026-01-10  
**状态**: 设计阶段

---

## 目录

1. [概述](#1-概述)
2. [核心玩法](#2-核心玩法)
3. [游戏机制](#3-游戏机制)
4. [资源系统](#4-资源系统)
5. [建筑系统](#5-建筑系统)
6. [敌人系统](#6-敌人系统)
7. [火种系统](#7-火种系统)
8. [关卡设计](#8-关卡设计)
9. [用户界面](#9-用户界面)
10. [美术风格](#10-美术风格)
11. [音效设计](#11-音效设计)
12. [技术规格](#12-技术规格)

---

## 1. 概述

### 1.1 游戏概念

**守焰者** 是一款 2D 俯视角塔防建造游戏。玩家在被黑暗笼罩的世界中，守护最后的火种，通过采集资源、建造防御工事来抵御从黑暗中涌来的怪物。

### 1.2 核心卖点

- **光明 vs 黑暗**: 独特的"火种照明"机制，只有被照亮的区域才能活动
- **建造 + 塔防**: 红警式的基地建设 + 塔防式的波次防御
- **资源管理**: 采集、加工、建造的完整产业链
- **紧迫感**: 波次倒计时带来的策略压力

### 1.3 目标平台

- Web 浏览器
- 移动端 (iOS / Android)

### 1.4 目标受众

- 喜欢塔防游戏的玩家
- 喜欢建造经营的玩家
- 休闲策略游戏爱好者
- 年龄: 12+

### 1.5 游戏时长

- **单局时长**: 15-30 分钟
- **目标波次**: 15 波
- **重玩价值**: 随机地图、不同策略路线

---

## 2. 核心玩法

### 2.1 游戏循环

开局 → 火种点燃，照亮初始区域
↓
建造期 → 采集资源，建造/升级建筑
↓
防御期 → 怪物进攻，防御塔自动攻击
↓
结算 → 存活则进入下一波，否则游戏结束
↓
(循环) 难度递增，直到火种满级或被摧毁


### 2.2 胜利条件

- 将火种升级到 **Lv.5**（最高级）
- 或存活 **15 波**怪物进攻

### 2.3 失败条件

- **火种被摧毁**（血量归零）

### 2.4 核心操作

| 操作 | 方式 |
|------|------|
| 选择建筑 | 点击底部建筑栏 |
| 放置建筑 | 点击地图上的合法位置 |
| 升级建筑 | 点击已有建筑 → 升级按钮 |
| 拆除建筑 | 点击已有建筑 → 拆除按钮（返还 50% 资源）|
| 移动视角 | 拖拽屏幕 / WASD 键 |
| 缩放视角 | 双指缩放 / 鼠标滚轮 |

---

## 3. 游戏机制

### 3.1 迷雾系统（光明与黑暗）

**核心规则**:
- 地图初始被"黑暗迷雾"笼罩
- 火种照亮周围一定半径的区域
- 只有被照亮的区域可以：
  - 看到地形和资源
  - 放置建筑
  - 看到敌人（敌人在黑暗中不可见）
- 敌人从黑暗区域的地图边缘刷出

**设计意图**:
- 创造探索感
- 限制初期扩张速度
- 让火种升级有明确收益

### 3.2 波次系统

| 参数 | 数值 |
|------|------|
| 总波次 | 15 波 |
| 波次间隔 | 60 秒（可调） |
| 敌人数量增长 | 每波 +20% |
| 敌人血量增长 | 每波 +10% |

**波次预告**:
- 下一波倒计时显示在 UI 上
- 倒计时 10 秒时，提示下一波敌人类型

### 3.3 建造规则

- 建筑只能放置在**照亮的区域**
- 建筑不能重叠
- 建筑不能放在资源点上（树、矿石）
- 部分建筑需要相邻资源（伐木场需要靠近树）

### 3.4 战斗系统

**防御塔行为**:
- 自动攻击射程内的敌人
- 优先攻击最近的敌人（可设置优先级）
- 攻击有冷却时间

**敌人行为**:
- 向火种移动（A* 寻路）
- 遇到城墙会攻击城墙
- 部分敌人会绕过障碍

---

## 4. 资源系统

### 4.1 资源类型

| 资源 | 图标 | 获取方式 | 主要用途 |
|------|------|---------|---------|
| 木材 | 🪵 | 砍树 / 伐木场 | 基础建筑、箭塔 |
| 石头 | 🪨 | 采矿 / 采石场 | 城墙、高级建筑 |
| 铁矿 | ⛏️ | 熔炉加工 | 高级塔、升级 |
| 水晶 | 🔮 | 稀有矿 / 水晶塔 | 魔法塔、火种升级 |

### 4.2 资源产出数值

| 来源 | 产出速度 |
|------|---------|
| 手动砍树 | 10 木材/次 |
| 伐木场 | 5 木材/秒 |
| 手动采矿 | 10 石头/次 |
| 采石场 | 5 石头/秒 |
| 熔炉 | 10 石头 → 5 铁/10秒 |
| 水晶塔 | 1 水晶/10秒 |

### 4.3 初始资源

| 难度 | 木材 | 石头 | 铁矿 | 水晶 |
|------|------|------|------|------|
| 简单 | 200 | 100 | 20 | 5 |
| 普通 | 100 | 50 | 10 | 0 |
| 困难 | 50 | 25 | 0 | 0 |

---

## 5. 建筑系统

### 5.1 防御建筑

#### 木墙
| 属性 | 数值 |
|------|------|
| 成本 | 5 木材 |
| 血量 | 100 |
| 功能 | 阻挡敌人移动 |
| 解锁 | 火种 Lv.1 |

#### 石墙
| 属性 | 数值 |
|------|------|
| 成本 | 10 石头 |
| 血量 | 300 |
| 功能 | 阻挡敌人移动 |
| 解锁 | 火种 Lv.2 |

#### 箭塔
| 属性 | 数值 |
|------|------|
| 成本 | 20 木材 + 10 石头 |
| 血量 | 150 |
| 伤害 | 20 |
| 攻速 | 1次/秒 |
| 射程 | 5 格 |
| 解锁 | 火种 Lv.1 |

#### 投石塔
| 属性 | 数值 |
|------|------|
| 成本 | 30 石头 + 10 铁 |
| 血量 | 200 |
| 伤害 | 50 (范围) |
| 攻速 | 0.5次/秒 |
| 射程 | 6 格 |
| 范围 | 2 格 |
| 解锁 | 火种 Lv.2 |

#### 火焰塔
| 属性 | 数值 |
|------|------|
| 成本 | 20 木材 + 20 水晶 |
| 血量 | 120 |
| 伤害 | 10/秒 (持续) |
| 效果 | 减速 30% |
| 射程 | 4 格 |
| 解锁 | 火种 Lv.3 |

#### 电磁塔
| 属性 | 数值 |
|------|------|
| 成本 | 50 铁 + 30 水晶 |
| 血量 | 180 |
| 伤害 | 40 (链式3目标) |
| 攻速 | 0.8次/秒 |
| 射程 | 5 格 |
| 解锁 | 火种 Lv.4 |

### 5.2 生产建筑

#### 伐木场
| 属性 | 数值 |
|------|------|
| 成本 | 30 木材 |
| 血量 | 100 |
| 产出 | 5 木材/秒 |
| 条件 | 需要靠近树木 |
| 解锁 | 火种 Lv.1 |

#### 采石场
| 属性 | 数值 |
|------|------|
| 成本 | 30 石头 |
| 血量 | 150 |
| 产出 | 5 石头/秒 |
| 条件 | 需要靠近矿石 |
| 解锁 | 火种 Lv.2 |

#### 熔炉
| 属性 | 数值 |
|------|------|
| 成本 | 50 石头 + 20 木材 |
| 血量 | 200 |
| 转化 | 10 石头 → 5 铁 |
| 周期 | 10 秒 |
| 解锁 | 火种 Lv.3 |

#### 水晶塔
| 属性 | 数值 |
|------|------|
| 成本 | 100 石头 + 50 铁 |
| 血量 | 250 |
| 产出 | 1 水晶/10秒 |
| 解锁 | 火种 Lv.4 |

### 5.3 建筑升级

每个建筑可升级 3 次：

| 等级 | 效果 | 成本 |
|------|------|------|
| Lv.2 | 属性 +30% | 基础成本 ×1 |
| Lv.3 | 属性 +60% | 基础成本 ×2 |
| Lv.4 | 属性 +100% | 基础成本 ×3 |

---

## 6. 敌人系统

### 6.1 敌人列表

#### 小鬼
| 属性 | 数值 |
|------|------|
| 血量 | 50 |
| 伤害 | 10 |
| 速度 | 快 |
| 特性 | 无 |
| 首次出现 | 第 1 波 |

#### 石像鬼
| 属性 | 数值 |
|------|------|
| 血量 | 200 |
| 伤害 | 25 |
| 速度 | 慢 |
| 特性 | 优先攻击城墙 |
| 首次出现 | 第 3 波 |

#### 暗影狼
| 属性 | 数值 |
|------|------|
| 血量 | 80 |
| 伤害 | 20 |
| 速度 | 极快 |
| 特性 | 绕过障碍物 |
| 首次出现 | 第 5 波 |

#### 巨魔
| 属性 | 数值 |
|------|------|
| 血量 | 500 |
| 伤害 | 50 |
| 速度 | 慢 |
| 特性 | 范围攻击 |
| 首次出现 | 第 7 波 |

#### 腐化者
| 属性 | 数值 |
|------|------|
| 血量 | 150 |
| 伤害 | 15 |
| 速度 | 中 |
| 特性 | 攻击感染建筑（效率-50%）|
| 首次出现 | 第 10 波 |

#### 黑暗领主 (Boss)
| 属性 | 数值 |
|------|------|
| 血量 | 2000 |
| 伤害 | 80 |
| 速度 | 慢 |
| 特性 | 每 10 秒召唤 3 只小鬼 |
| 首次出现 | 第 15 波 |

### 6.2 敌人 AI

**寻路规则**:
1. 目标: 火种
2. 使用 A* 算法寻路
3. 遇到城墙: 攻击城墙
4. 城墙被摧毁: 重新寻路

**攻击优先级**:
1. 阻挡路径的城墙
2. 路径上的防御塔
3. 火种

### 6.3 波次设计

| 波次 | 敌人组合 | 难度 |
|------|---------|------|
| 1-2 | 小鬼 ×10-15 | 入门 |
| 3-4 | 小鬼 + 石像鬼 | 简单 |
| 5-6 | 小鬼 + 暗影狼 | 中等 |
| 7-9 | 混合 + 巨魔 | 困难 |
| 10-14 | 混合 + 腐化者 | 高难 |
| 15 | 全种类 + 黑暗领主 | Boss |

---

## 7. 火种系统

### 7.1 火种属性

| 等级 | 血量 | 照亮半径 | 升级成本 |
|------|------|---------|---------|
| Lv.1 | 500 | 5 格 | - |
| Lv.2 | 700 | 8 格 | 50 水晶 |
| Lv.3 | 900 | 12 格 | 100 水晶 |
| Lv.4 | 1200 | 16 格 | 200 水晶 |
| Lv.5 | 1500 | 20 格 | 400 水晶 |

### 7.2 解锁内容

| 火种等级 | 解锁建筑 |
|---------|---------|
| Lv.1 | 木墙、箭塔、伐木场 |
| Lv.2 | 石墙、投石塔、采石场 |
| Lv.3 | 火焰塔、熔炉 |
| Lv.4 | 电磁塔、水晶塔 |
| Lv.5 | 胜利！ |

### 7.3 火种恢复

- 火种不会自动恢复血量
- 可消耗 20 水晶恢复 200 血量
- 每波结束后恢复 50 血量

---

## 8. 关卡设计

### 8.1 地图规格

| 参数 | 数值 |
|------|------|
| 地图尺寸 | 40×40 格 |
| 格子大小 | 32×32 像素 |
| 火种位置 | 地图中央 |

### 8.2 地图元素

| 元素 | 描述 |
|------|------|
| 草地 | 可建造区域 |
| 树木 | 木材资源，可砍伐 |
| 矿石 | 石头资源，可开采 |
| 水晶矿 | 稀有水晶资源 |
| 水域 | 不可通过，不可建造 |
| 岩石 | 不可通过，不可建造 |

### 8.3 资源分布

- **树木**: 主要分布在地图四周
- **矿石**: 分散在中等距离
- **水晶矿**: 稀少，分布在较远位置

### 8.4 敌人刷新点

- 地图四边的黑暗区域
- 每波随机选择 1-4 个方向
- 后期波次会四面夹击

---

## 9. 用户界面

### 9.1 主界面布局

┌─────────────────────────────────────────────┐
│ 🪵 156 🪨 89 ⛏️ 34 🔮 12 │ 波次: 5/15 │
├─────────────────────────────────────────────┤
│ │
│ │
│ 游戏主视图 │
│ (地图 + 建筑 + 敌人) │
│ │
│ │
├─────────────────────────────────────────────┤
│ [木墙] [石墙] [箭塔] [投石塔] │ 下波: 45s │
└─────────────────────────────────────────────┘


### 9.2 UI 元素

**顶部状态栏**:
- 资源数量（木材、石头、铁、水晶）
- 当前波次 / 总波次
- 火种血量条

**底部建筑栏**:
- 可用建筑图标
- 建筑成本显示
- 已选中建筑高亮

**右侧信息**:
- 下一波倒计时
- 下一波敌人预告
- 设置按钮

**建筑详情面板**:
- 点击已有建筑显示
- 显示当前属性
- 升级/拆除按钮

---

## 10. 美术风格

### 10.1 整体风格

- **风格**: 像素风 / 低多边形
- **视角**: 2D 俯视 45°
- **色调**: 
  - 光明区域：温暖的橙黄色调
  - 黑暗区域：冷色调蓝紫色

### 10.2 色彩方案

| 元素 | 主色 |
|------|------|
| 火种 | 橙红色 #FF6B35 |
| 照明区域 | 暖黄色渐变 |
| 黑暗区域 | 深紫色 #1A1A2E |
| 草地 | 绿色 #4A7C59 |
| 城墙 | 灰色 #8B8B8B |
| 敌人 | 紫黑色调 |

### 10.3 动画需求

| 对象 | 动画 |
|------|------|
| 火种 | 火焰摇曳 |
| 防御塔 | 攻击动画 |
| 敌人 | 移动、攻击、死亡 |
| 建筑 | 建造完成特效 |
| 资源 | 采集特效 |

---

## 11. 音效设计

### 11.1 背景音乐

| 场景 | 风格 |
|------|------|
| 主菜单 | 神秘、史诗 |
| 建造期 | 平和、紧张感低 |
| 防御期 | 紧张、战斗感 |
| Boss 战 | 高燃、史诗 |
| 胜利 | 欢快、成就感 |
| 失败 | 悲伤、压抑 |

### 11.2 音效列表

| 事件 | 音效 |
|------|------|
| 放置建筑 | 建造音效 |
| 建筑完成 | 完成提示音 |
| 采集资源 | 砍伐/挖掘音 |
| 箭塔攻击 | 弓箭发射 |
| 投石塔攻击 | 石头落地 |
| 火焰塔攻击 | 火焰燃烧 |
| 敌人死亡 | 怪物惨叫 |
| 城墙受击 | 撞击音 |
| 波次开始 | 警报音 |
| 火种受损 | 紧急警报 |

---

## 12. 技术规格

### 12.1 开发环境

| 项目 | 选择 |
|------|------|
| 引擎 | UrhoX |
| 语言 | Lua |
| 渲染 | 2D (NanoVG + Sprite) |
| 平台 | Web / Mobile |

### 12.2 性能目标

| 指标 | 目标 |
|------|------|
| 目标帧率 | 60 FPS |
| 最大敌人数 | 100 同屏 |
| 最大建筑数 | 200 |
| 加载时间 | < 3 秒 |

### 12.3 存档系统

- 自动保存每波结束时的状态
- 支持手动保存/读取
- 存储: 本地存储 (LocalStorage)

### 12.4 核心模块
scripts/
├── main.lua # 入口文件
├── Game/
│ ├── GameManager.lua # 游戏主控制
│ ├── WaveManager.lua # 波次管理
│ └── ResourceManager.lua # 资源管理
├── Map/
│ ├── TileMap.lua # 地图系统
│ └── FogOfWar.lua # 迷雾系统
├── Buildings/
│ ├── BuildingBase.lua # 建筑基类
│ ├── Wall.lua # 城墙
│ └── Tower.lua # 防御塔
├── Enemies/
│ ├── EnemyBase.lua # 敌人基类
│ ├── Goblin.lua # 小鬼
│ └── Boss.lua # Boss
├── UI/
│ ├── HUD.lua # 主界面
│ ├── BuildPanel.lua # 建筑面板
│ └── InfoPanel.lua # 信息面板
└── Utils/
├── Pathfinding.lua # 寻路算法
└── SaveLoad.lua # 存档系统


---

## 附录 A: 数值平衡表

### 经济平衡

| 波次 | 预期资源 | 可建建筑数 |
|------|---------|-----------|
| 1-3 | 200 木 + 100 石 | 5-8 |
| 4-6 | 500 木 + 300 石 | 15-20 |
| 7-9 | 1000 木 + 600 石 + 100 铁 | 30-40 |
| 10+ | 充足 | 50+ |

---

## 附录 B: 开发里程碑

### Phase 1: 核心原型
- [ ] 地图渲染
- [ ] 建造系统
- [ ] 火种与照明
- [ ] 基础敌人 AI

### Phase 2: 战斗系统
- [ ] 防御塔攻击
- [ ] 敌人寻路
- [ ] 波次系统
- [ ] 伤害计算

### Phase 3: 内容完善
- [ ] 全部建筑
- [ ] 全部敌人
- [ ] 数值平衡
- [ ] UI 界面

### Phase 4: 打磨优化
- [ ] 美术资源
- [ ] 音效音乐
- [ ] 性能优化
- [ ] Bug 修复

---

## 附录 C: 参考游戏

| 游戏 | 参考要素 |
|------|---------|
| They Are Billions | 建造 + 波次防御 |
| Mindustry | 资源链 + 塔防 |
| Kingdom | 简化的横版防御 |
| 红色警戒 | 建造界面、即时策略 |

---

**文档结束**

*守焰者 / Flame Keeper - 愿火焰永不熄灭。* 🔥